<!DOCTYPE html>
<html lang="de">
<head>
  <title>Global Carbon Insights</title>
  <!--Einbindung Bootstrap Framework für CSS-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2/dist/css/bootstrap.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    /* ... CSS-Stile für Header, Main-Content und Footer werden hier definiert ... */
    /* Stile für die Menüplatzierung bei rtl-Sprachen */
    /*Responsives Design fuer header*/
  </style>
</head>

<body>
  <div class="container">
    <header class="row align-items-center">
      <!--Globale Navigation-->
      <nav class="d-flex justify-content-end py-3 my-4 border-top">
        <ul class="nav">
          <li class="nav-item"><a href="https://www.twitter.com/globalcarboninsights">Twitter</a></li>
          <li class="nav-item"><a href="https://www.instagram.com/globalcarboninsights">Instagram</a></li>
          <li class="nav-item"><a href="https://www.facebook.com/globalcarboninsights">Facebook</a></li>
        </ul>
      </nav>
      <div class="col-sm-4">
        <img src="Logo1.jpg" alt="Logo" class="img-fluid">
      </div>
      <div class="col-sm-8">
        <h1>Global Carbon Insights e.V.</h1>
        <h2>Unsere Mission sind Transparenz und Aufklärung!</h2>
      </div>
    </header>

    <!--Menue der internen Links zur Navigation auf der Webseite-->
    <main>
      <div id="menue">
        <nav class="d-flex flex-shrink-0 p-2" style="width: 180px">
          <ul class="nav mb-auto">
            <li><a href="#about-section">Über uns</a></li>
            <li><a href="#countries_CO2">CO2 der Länder</a></li>
            <li><a href="#companies_CO2">CO2 der Unternehmen</a></li>
          </ul>
        </nav>
      </div>

      <div class="col-md-9"> 
        <!-- Section - Über uns -->    
        <div class="list-group mb-4">
          <section id="about-section" class="list-group-item">
            <!-- ... Inhalt für den Über uns-Abschnitt ... -->
          </section>
        </div>

        <!-- Section - CO2-Footprint der Länder -->
        <div class="list-group mb-4"> 
          <section id="countries_CO2" class="list-group-item">
            <h1>CO2-Fooprint der Länder</h1>
            <!-- ... Inhalt für den CO2-Footprint der Länder ... -->

            
                    <!-- Suchfeld zum Filtern nach einzelnen Ländern -->
                    <form>
                        <input type="text" name="suche" id="search-country" placeholder="Suche nach Land" oninput="filterByCountry(this.value)">
                    </form>
                
            
                    <!-- Drop-Down-Menü zum Filtern der Länder nach Alphabet, nach CO2-Ausstoß aufsteigend oder absteigend -->
                    <form>
                        <select id="sortOption" onchange="sortTable()">
                            <option value="default">Sortieren nach:</option>
                            <option value="alphabetical">Land (alphabetisch)</option>
                            <option value="emissions_asc">CO²-Emissionen (aufsteigend)</option>
                            <option value="emissions_desc">CO²-Emissionen (absteigend)</option>
                        </select>
                    </form>

                    <!--Tabelle CO2 Emissionen der Laender-->
                    <table id="country-table">
                            <thead>
                                <tr>
                                    <th>Land</th>
                                    <th>tCO2/Kopf</th>
                                </tr>
                            </thead>
                            <tbody id="country-data">
                                <!-- Hier werden die JSON-Daten angezeigt -->
                            </tbody>
                        </table>
          </section>


        <!-- Section - CO2-Footprint der Unternehmen -->
        <div class="list-group mb-4">
          <section id="companies_CO2"  class="list-group-item">
            <h1>CO2-Fooprint der Unternehmen</h1>
            <!-- ... Inhalt für den CO2-Footprint der Unternehmen ... -->

                <!--Suchfeld zum Filtern nach einzelnen Unternehmen-->
                <form>
                  <input type="text" name="suche" id="search-company" placeholder="Suche nach Unternehmen" oninput="filterByCompany(this.value)">
                </form>
    
                <!--Drop-Down Menue zum Filtern der Unternehmen nach Alphabet, nach CO2 Ausstoss aufsteigend oder absteigend-->
                <form>
                    <select id="sortOptionComp" onchange="sortTableCompany()">
                    <option value="default">Sortieren nach:</option>
                    <option value="alphabetical">Unternehmen (alphabetisch)</option>
                    <option value="emissions_asc">CO²-Emissionen (aufsteigend)</option>
                    <option value="emissions_desc">CO²-Emissionen (absteigend)</option>
                </select>
                </form>

                <table id="company-table">
                  <thead>
                    <tr>
                      <th>Unternehmen</th>
                      <th>CO2 Ausstoß in Tonnen</th>
                    </tr>
                  </thead>
                  <tbody id="company-data">
                    <!-- Hier werden die JSON-Daten angezeigt -->
                  </tbody>
                </table>

          </section>
        </div> 
      </div>  
    </main>

    <footer class="d-flex justify-content-end py-3 my-4 border-top">
      <nav>
        <ul class="nav">
          <li class="nav-item"><a href="contact.html">Kontakt</a></li>
          <li class="nav-item"><a href="imprint.html">Impressum</a></li>
        </ul>
      </nav>
    </footer>
  </div>

  <!-- Skript für das Sortieren, Filtern und Anzeigen der JSON-Daten -->
  <script>

    // Funktion, um die Browsersprache zu erkennen und bei Right-To-Left Sprache (z.B. Arabisch)
    // ausrichtung der Webseite = rechtsbündig
    var lang = window.navigator.language || window.navigator.userLanguage;
    var isRtlLanguage = ["ar", "he", "fa", "ur"].includes(lang.substr(0, 2));
    
    // Ausgabe des erkannten Werts der Browsersprache in der Konsole
    console.log("Erkannte Browsersprache:", lang);

    // CSS-Klasse basierend auf der Sprache hinzufügen
    var navbar = document.querySelector('.navbar');
    if (isRtlLanguage) {
        navbar.classList.add('navbar-rtl');
    }

    const jsonData = {
      "countries": [
        // ... (Ausschnitt: JSON-Daten für Länder)
        {"tCO2/Kopf": 38.2, "Land": "Luxemburg"},
        {"tCO2/Kopf": 25.4, "Land": "Katar"},
        {"tCO2/Kopf": 23.2, "Land": "UAE"},
        {"tCO2/Kopf": 23.2, "Land": "Kuwait"},
        {"tCO2/Kopf": 23.2, "Land": "Brunei"},
        {"tCO2/Kopf": 19.2, "Land": "Singapur"},
        {"tCO2/Kopf": 18.4, "Land": "Trinidad & Tobago"}
      ]
    };
  
    const jsonData2 = {
      "companies": [
        // ... (Ausschnitt: JSON-Daten für Unternehmen)
        {"name": "Saudi Aramco","co2_ausstoß": "500"},
        {"name": "Chevron","co2_ausstoß": "41"},
        {"name": "ExxonMobil","co2_ausstoß": "36"},
        {"name": "BP","co2_ausstoß": "34"}
      ]
    };
  
    function anzeigenDatenCountries() {
      // ... (Funktion zum Anzeigen der Länder-Daten in HTML)
      const tableBody = document.getElementById('country-data');

        jsonData.countries.forEach(country => {
            const row = document.createElement('tr');
            const landCell = document.createElement('td');
            const tco2Cell = document.createElement('td');

            landCell.textContent = country.Land;
            tco2Cell.textContent = country['tCO2/Kopf'];

            row.appendChild(landCell);
            row.appendChild(tco2Cell);

            tableBody.appendChild(row);
        });
    }
  
    function anzeigenDatenCompanies() {
      // ... (Funktion zum Anzeigen der Unternehmen-Daten in HTML)
      const tableBody = document.getElementById('company-data');

        jsonData2.companies.forEach(companies => {
            const row = document.createElement('tr');
            const nameCell = document.createElement('td');
            const co2_ausstoßCell = document.createElement('td');

            nameCell.textContent = companies.name;
            co2_ausstoßCell.textContent = companies['co2_ausstoß'];

            row.appendChild(nameCell);
            row.appendChild(co2_ausstoßCell);

            tableBody.appendChild(row);
});
    }
  
    function sortTable() {
      // ... (Funktion zum Sortieren der Länder-Tabelle)
      const table = document.getElementById('country-table');
        const rows = table.getElementsByTagName('tr');
        const sortOption = document.getElementById('sortOption').value;

        if (sortOption === 'alphabetical') {
          const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = a.getElementsByTagName('td')[0].textContent.toLowerCase();
            const cellB = b.getElementsByTagName('td')[0].textContent.toLowerCase();
            return cellA.localeCompare(cellB);
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          }
        } else if (sortOption === 'emissions_asc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellA - cellB;
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          };  

        } else if (sortOption === 'emissions_desc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellB - cellA; // Reihenfolge umgekehrt, um absteigende Sortierung zu erhalten
          });

          for (let i = 0; i < sortedRows.length; i++) {
          table.appendChild(sortedRows[i]);
            };
        }
    }
  
    function sortTableCompany() {
      // ... (Funktion zum Sortieren der Unternehmen-Tabelle)
      const table = document.getElementById('company-table');
        const rows = table.getElementsByTagName('tr');
        const sortOption = document.getElementById('sortOptionComp').value;

        if (sortOption === 'alphabetical') {
          const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = a.getElementsByTagName('td')[0].textContent.toLowerCase();
            const cellB = b.getElementsByTagName('td')[0].textContent.toLowerCase();
            return cellA.localeCompare(cellB);
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          }
        } else if (sortOption === 'emissions_asc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellA - cellB;
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          };  

        } else if (sortOption === 'emissions_desc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellB - cellA; // Reihenfolge umgekehrt, um absteigende Sortierung zu erhalten
          });

          for (let i = 0; i < sortedRows.length; i++) {
          table.appendChild(sortedRows[i]);
            };
        }
    }
  
    function filterByCountry(searchTerm) {
      // ... (Funktion zum Filtern der Länder nach Namen)
          const table = document.getElementById('country-table');
          const rows = table.getElementsByTagName('tr');

          for (let i = 1; i < rows.length; i++) {
            const row = rows[i];
            const countryName = row.getElementsByTagName('td')[0].textContent.toLowerCase();  //textContent verhindert Code-Injection

            if (countryName.includes(searchTerm.toLowerCase())) {
              row.style.display = '';
            } else {
              row.style.display = 'none';
            }
          }
    }

            
    function filterByCompany(searchTerm) {
        // Funktion zum Filtern der Unternehmen nach Namen (Suchfeld)
          const table = document.getElementById('company-table');
          const rows = table.getElementsByTagName('tr');

          for (let i = 1; i < rows.length; i++) {
            const row = rows[i];
            const companyName = row.getElementsByTagName('td')[0].textContent.toLowerCase();  //textContent verhindert Code-Injection

            if (companyName.includes(searchTerm.toLowerCase())) {
              row.style.display = '';
            } else {
              row.style.display = 'none';
            }
          }
        }

        
        document.getElementById('search-country').addEventListener('keypress', function (event) {
            // Event-Handler soll neuladen der Seite bei druecken der Return Taste in der Laendersuche verhindern
            if (event.key === 'Enter') {
              event.preventDefault(); // Verhindert das Neuladen der Seite
              this.blur(); // Suchfeld verliert Fokus
            }
          });

          
        document.getElementById('search-company').addEventListener('keypress', function (event) {
            // Event-Handler soll neuladen der Seite bei druecken der Return Taste in der Laendersuche verhindern
            if (event.key === 'Enter') {
              event.preventDefault(); // Verhindert das Neuladen der Seite
              this.blur(); // Suchfeld verliert Fokus
            }
          });

          
      window.onload = function() {
        //Funktion zum Anzeigen der Daten in den Tabellen (Laender und Unternehmen)
        anzeigenDatenCountries();
        anzeigenDatenCompanies();
      };
  
  </script>
</body>
</html>
