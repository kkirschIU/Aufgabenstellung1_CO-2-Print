<script>

    // Funktion, um die Browsersprache zu erkennen und bei Right-To-Left Sprache (z.B. Arabisch)
    // ausrichtung der Webseite = rechtsbündig
    var lang = window.navigator.language || window.navigator.userLanguage;
    var isRtlLanguage = ["ar", "he", "fa", "ur"].includes(lang.substr(0, 2));
    
    // Ausgabe des erkannten Werts der Browsersprache in der Konsole
    console.log("Erkannte Browsersprache:", lang);

    // CSS-Klasse basierend auf der Sprache hinzufügen
    var navbar = document.querySelector('.navbar');
    if (isRtlLanguage) {
        navbar.classList.add('navbar-rtl');
    }

    const jsonData = {
      "countries": [
        // ... (Ausschnitt: JSON-Daten für Länder)
        {"tCO2/Kopf": 38.2, "Land": "Luxemburg"},
        {"tCO2/Kopf": 25.4, "Land": "Katar"},
        {"tCO2/Kopf": 23.2, "Land": "UAE"},
        {"tCO2/Kopf": 23.2, "Land": "Kuwait"},
        {"tCO2/Kopf": 23.2, "Land": "Brunei"},
        {"tCO2/Kopf": 19.2, "Land": "Singapur"},
        {"tCO2/Kopf": 18.4, "Land": "Trinidad & Tobago"}
      ]
    };
  
    const jsonData2 = {
      "companies": [
        // ... (Ausschnitt: JSON-Daten für Unternehmen)
        {"name": "Saudi Aramco","co2_ausstoß": "500"},
        {"name": "Chevron","co2_ausstoß": "41"},
        {"name": "ExxonMobil","co2_ausstoß": "36"},
        {"name": "BP","co2_ausstoß": "34"}
      ]
    };
  
    function anzeigenDatenCountries() {
      // ... (Funktion zum Anzeigen der Länder-Daten in HTML)
      const tableBody = document.getElementById('country-data');

        jsonData.countries.forEach(country => {
            const row = document.createElement('tr');
            const landCell = document.createElement('td');
            const tco2Cell = document.createElement('td');

            landCell.textContent = country.Land;
            tco2Cell.textContent = country['tCO2/Kopf'];

            row.appendChild(landCell);
            row.appendChild(tco2Cell);

            tableBody.appendChild(row);
        });
    }
  
    function anzeigenDatenCompanies() {
      // ... (Funktion zum Anzeigen der Unternehmen-Daten in HTML)
      const tableBody = document.getElementById('company-data');

        jsonData2.companies.forEach(companies => {
            const row = document.createElement('tr');
            const nameCell = document.createElement('td');
            const co2_ausstoßCell = document.createElement('td');

            nameCell.textContent = companies.name;
            co2_ausstoßCell.textContent = companies['co2_ausstoß'];

            row.appendChild(nameCell);
            row.appendChild(co2_ausstoßCell);

            tableBody.appendChild(row);
});
    }
  
    function sortTable() {
      // ... (Funktion zum Sortieren der Länder-Tabelle)
      const table = document.getElementById('country-table');
        const rows = table.getElementsByTagName('tr');
        const sortOption = document.getElementById('sortOption').value;

        if (sortOption === 'alphabetical') {
          const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = a.getElementsByTagName('td')[0].textContent.toLowerCase();
            const cellB = b.getElementsByTagName('td')[0].textContent.toLowerCase();
            return cellA.localeCompare(cellB);
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          }
        } else if (sortOption === 'emissions_asc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellA - cellB;
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          };  

        } else if (sortOption === 'emissions_desc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellB - cellA; // Reihenfolge umgekehrt, um absteigende Sortierung zu erhalten
          });

          for (let i = 0; i < sortedRows.length; i++) {
          table.appendChild(sortedRows[i]);
            };
        }
    }
  
    function sortTableCompany() {
      // ... (Funktion zum Sortieren der Unternehmen-Tabelle)
      const table = document.getElementById('company-table');
        const rows = table.getElementsByTagName('tr');
        const sortOption = document.getElementById('sortOptionComp').value;

        if (sortOption === 'alphabetical') {
          const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = a.getElementsByTagName('td')[0].textContent.toLowerCase();
            const cellB = b.getElementsByTagName('td')[0].textContent.toLowerCase();
            return cellA.localeCompare(cellB);
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          }
        } else if (sortOption === 'emissions_asc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellA - cellB;
          });

          for (let i = 0; i < sortedRows.length; i++) {
            table.appendChild(sortedRows[i]);
          };  

        } else if (sortOption === 'emissions_desc') {
            const sortedRows = Array.from(rows).slice(1).sort((a, b) => {
            const cellA = parseFloat(a.getElementsByTagName('td')[1].textContent);
            const cellB = parseFloat(b.getElementsByTagName('td')[1].textContent);
            return cellB - cellA; // Reihenfolge umgekehrt, um absteigende Sortierung zu erhalten
          });

          for (let i = 0; i < sortedRows.length; i++) {
          table.appendChild(sortedRows[i]);
            };
        }
    }
  
    function filterByCountry(searchTerm) {
      // ... (Funktion zum Filtern der Laender nach Namen)
          const table = document.getElementById('country-table');
          const rows = table.getElementsByTagName('tr');

          for (let i = 1; i < rows.length; i++) {
            const row = rows[i];
            const countryName = row.getElementsByTagName('td')[0].textContent.toLowerCase();  //textContent verhindert Code-Injection

            if (countryName.includes(searchTerm.toLowerCase())) {
              row.style.display = '';
            } else {
              row.style.display = 'none';
            }
          }
    }

            
    function filterByCompany(searchTerm) {
        // Funktion zum Filtern der Unternehmen nach Namen (Suchfeld)
          const table = document.getElementById('company-table');
          const rows = table.getElementsByTagName('tr');

          for (let i = 1; i < rows.length; i++) {
            const row = rows[i];
            const companyName = row.getElementsByTagName('td')[0].textContent.toLowerCase();  //textContent verhindert Code-Injection

            if (companyName.includes(searchTerm.toLowerCase())) {
              row.style.display = '';
            } else {
              row.style.display = 'none';
            }
          }
        }

        
        document.getElementById('search-country').addEventListener('keypress', function (event) {
            // Event-Handler soll neuladen der Seite bei druecken der Return Taste in der Laendersuche verhindern
            if (event.key === 'Enter') {
              event.preventDefault(); // Verhindert das Neuladen der Seite
              this.blur(); // Suchfeld verliert Fokus
            }
          });

          
        document.getElementById('search-company').addEventListener('keypress', function (event) {
            // Event-Handler soll neuladen der Seite bei druecken der Return Taste in der Laendersuche verhindern
            if (event.key === 'Enter') {
              event.preventDefault(); // Verhindert das Neuladen der Seite
              this.blur(); // Suchfeld verliert Fokus
            }
          });

          
      window.onload = function() {
        //Funktion zum Anzeigen der Daten in den Tabellen (Laender und Unternehmen)
        anzeigenDatenCountries();
        anzeigenDatenCompanies();
      };
  
  </script>
  